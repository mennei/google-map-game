{"version":3,"file":"static/webpack/static\\development\\pages\\index.js.7ba509f76f284aecef29.hot-update.js","sources":["webpack:///./src/fe/MapContainer.js"],"sourcesContent":["import React, {Component} from 'react';\r\nimport fetch from 'isomorphic-unfetch';\r\nimport {Map, GoogleApiWrapper, Marker} from 'google-maps-react';\r\n\r\nconst mapStyles = {\r\n  width: '100%',\r\n  height: '100%',\r\n};\r\n\r\nclass MapContainer extends Component {\r\n  state = {\r\n    ballLocation: {\r\n      lat: 0,\r\n      lng: 0,\r\n    },\r\n    goalLocation: {\r\n      lat: 0,\r\n      lng: 0,\r\n    },\r\n    loading: true,\r\n  };\r\n\r\n  componentDidMount () {\r\n    navigator.geolocation.getCurrentPosition (position => {\r\n      const {latitude, longitude} = position.coords;\r\n      this.setState (\r\n        {\r\n          ballLocation: {\r\n            lat: 33.02499278880199,\r\n            lng: 35.28442144393921,\r\n          },\r\n        },\r\n        () => {\r\n          console.log (this.state);\r\n        }\r\n      );\r\n    });\r\n  }\r\n  componentDidUpdate () {\r\n    const {loading, ballLocation} = this.state;\r\n    const url = `http://localhost:3000/api/v1/googleMap/getGoalLocationService?latitude=${ballLocation.lat}&longitude=${ballLocation.lng}`;\r\n    if (loading) {\r\n      fetch (url)\r\n        .then (resopnse => resopnse.json ())\r\n        .then (data => {\r\n          this.setState ({\r\n            goalLocation: {\r\n              lat: data.data.lat,\r\n              lng: data.data.lng,\r\n            },\r\n            loading: false,\r\n          });\r\n        })\r\n        .catch (err => console.log (err));\r\n    }\r\n  }\r\n\r\n  onMarkerDragEnd = coord => {\r\n    const {latLng} = coord;\r\n    const lat = latLng.lat ();\r\n    const lng = latLng.lng ();\r\n    this.setState (\r\n      {\r\n        ballLocation: {lat: lat, lng: lng},\r\n        loading: false,\r\n      },\r\n      () => {\r\n        let {ballLocation, goalLocation} = this.state;\r\n        ballLocation = JSON.stringify (ballLocation);\r\n        goalLocation = JSON.stringify (goalLocation);\r\n        return fetch (\r\n          `http://localhost:3000/api/v1/googleMap/getDistance?ballLocation=${ballLocation}&goalLocation=${goalLocation}`\r\n        )\r\n          .then (resopnse => resopnse.json ())\r\n          .then (data => {\r\n            this.setState ({\r\n              ballLocation: {lat: lat, lng: lng},\r\n              loading: false,\r\n            });\r\n            if (data && data['data'] < 0.01) {\r\n              console.log ('GOAL!!!!!!!!!');\r\n              alert ('GOAL!!!!!!');\r\n            }\r\n          })\r\n          .catch (err => console.log (err));\r\n      }\r\n    );\r\n  };\r\n\r\n  render () {\r\n    const {loading, ballLocation, goalLocation} = this.state;\r\n    const {google} = this.props;\r\n\r\n    if (loading) {\r\n      return null;\r\n    }\r\n    return (\r\n      <Map\r\n        google={google}\r\n        zoom={16}\r\n        style={mapStyles}\r\n        initialCenter={ballLocation}\r\n      >\r\n        <Marker\r\n          name={'Ball position'}\r\n          position={ballLocation}\r\n          icon={{\r\n            url: 'static/ball.png',\r\n            anchor: new google.maps.Point (32, 32),\r\n            scaledSize: new google.maps.Size (34, 34),\r\n          }}\r\n          draggable={true}\r\n          onDragend={(t, map, coord) => this.onMarkerDragEnd (coord)}\r\n        />\r\n\r\n        <Marker\r\n          name={'Goal position'}\r\n          position={{lat: goalLocation.lat, lng: goalLocation.lng}}\r\n          icon={{\r\n            url: 'static/goal.png',\r\n            anchor: new google.maps.Point (32, 32),\r\n            scaledSize: new google.maps.Size (34, 34),\r\n          }}\r\n        />\r\n\r\n      </Map>\r\n    );\r\n  }\r\n}\r\n\r\nexport default GoogleApiWrapper ({\r\n  apiKey: 'AIzaSyDUb9IkmIUP3Wlzir40A0jn3bR4FbBpl1k',\r\n}) (MapContainer);\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAEA;AACA;AACA;AAFA;AACA;AAIA;;;;;;;;;;;;;;;;;;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AAIA;AATA;AACA;AA8CA;AAAA;AAEA;AACA;AACA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AAFA;AAIA;AAAA;AAAA;AAEA;AACA;AACA;AAGA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AAFA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;;;;;;AAlEA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AAFA;AADA;AAOA;AACA;AAEA;AACA;;;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAEA;AACA;AAAA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AAFA;AAIA;AALA;AAOA;AACA;AAAA;AACA;AACA;;;AAkCA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AAJA;AAOA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAAA;AAAA;AATA;AAaA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAHA;AAHA;AAYA;;;;AAtHA;AACA;AAwHA;AACA;AADA;;;;A","sourceRoot":""}